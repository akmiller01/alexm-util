{
return(
ddply(data,.(cc),function(x)
{
naLen <- nrow(x[which(is.na(x$value)),])
allLen <- nrow(x)
valueLen <- allLen-naLen
if(valueLen>=1)
{
for(i in 1:length(x$value))
{
if(!is.na(x$value[i])){
latestcc = x$cc[i]
latestYear = x$year[i]
latestVal = x$value[i]
}
}
}
else
{
latestcc = x$cc[1]
latestYear = max(x$year)
latestVal = NA
}
y <- c(latestYear,latestVal)
return(y)
}
)
)
}
data <- latestYear(data)
latestYear <- function(data)
{
return(
ddply(data,.(cc),function(x)
{
for(i in 1:length(x$value))
{
if(!is.na(x$value[i])){
latestcc = x$cc[i]
latestYear = x$year[i]
latestVal = x$ccyear[i]
}
}
y <- c(latestYear,latestVal)
return(y)
}
)
)
}
data <- latestYear(data)
latestYear <- function(data)
{
return(
ddply(data,.(cc),function(x)
{
for(i in 1:length(x$value))
{
latestcc = x$cc[i]
latestYear = x$year[i]
latestVal = x$ccyear[i]
}
y <- c(latestYear,latestVal)
return(y)
}
)
)
}
data <- latestYear(data)
latestYear <- function(data)
{
return(
ddply(data,.(cc),function(x)
{
for(i in 1:length(x$ccyear))
{
latestcc = x$cc[i]
latestYear = x$year[i]
latestVal = x$ccyear[i]
}
y <- c(latestYear,latestVal)
return(y)
}
)
)
}
data <- latestYear(data)
View(data)
data2 <- read.csv("D:/Documents/Data/DHS map/matches.csv",as.is=TRUE)
data2$cc <- sapply(data2$ccyear,substr,start=1,stop=2)
data2$year <- sapply(data2$ccyear,substr,start=3,stop=6)
length(unique(data2$cc))
write.csv(data,"D:/Documents/Data/DHS map/matches_latest.csv",row.names=FALSE)
read.csv("D:/Documents/Data/DHS map/matches.csv",as.is=TRUE)
data$cc <- sapply(data$ccyear,substr,start=1,stop=2)
data$year <- sapply(data$ccyear,substr,start=3,stop=6)
data <- read.csv("D:/Documents/Data/DHS map/matches.csv",as.is=TRUE)
data$cc <- sapply(data$ccyear,substr,start=1,stop=2)
data$year <- sapply(data$ccyear,substr,start=3,stop=6)
names(data)
dat <- ddply(data,.(cc),function(x)
{
for(i in 1:length(x$ccyear))
{
latestName <- x$name[i]
latestCCyear = x$ccyear[i]
latestCC = x$cc[i]
latestYear = x$year[i]
}
y <- c(latestName,latestCCyear,latestCC,latestYear)
return(y)
}
)
View(dat)
dat <- ddply(data,.(cc),function(x)
{
for(i in 1:length(x$ccyear))
{
latestName <- x$name[i]
latestCCyear = x$ccyear[i]
latestYear = x$year[i]
}
y <- c(latestName,latestCCyear,latestYear)
return(y)
}
)
names(dat) <- c("cc","name","ccyear","year")
View(dat)
write.csv(dat,"D:/Documents/Data/DHS map/matches_latest.csv",row.names=FALSE)
# library("devtools")
# devtools::install_github("ankitrohatgi/digitizeR")
library("digitizeR")
app <- wpd.launch()
wpd.close(app)
# library("devtools")
# devtools::install_github("ankitrohatgi/digitizeR")
library("digitizeR")
app <- wpd.launch()
wpd.close(app)
# library("devtools")
# devtools::install_github("ankitrohatgi/digitizeR")
library("digitizeR")
app <- wpd.launch()
wpd.close(app)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
dat <- read.csv("data.csv")
View(dat)
names(dat) <- c("iso3","type","ppp","year","X5")
keep <- c("iso3","type","ppp","year")
dat <- dat[keep]
View(dat)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
dat <- read.csv("data.csv")
names(dat) <- c("iso3","type","ppp","year","pop")
dat <- dat[order(dat$iso3,dat$year)]
dat <- dat[order(dat$iso3,dat$year),]
dat$latest <- rev(!duplicated(stunt.tab[,list(rev(stunt.tab$iso3))]))
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
dat <- read.csv("data.csv")
names(dat) <- c("iso3","type","ppp","year","pop")
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
rev(dat$iso3)
dat[,list(rev(dat$iso3))]
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
dat <- read.csv("data.csv")
names(dat) <- c("iso3","type","ppp","year","pop")
dat <- dat[order(dat$iso3,dat$year),]
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat[,list(rev(dat$iso3))]
dat$latest <- rev(!duplicated(dat[,rev(dat$iso3)]))
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
dat <- dat[order(dat$iso3,dat$year),]
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat <- data.table(dat)
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
View(dat)
dat <- subset(dat,latest)
View(dat)
pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
names(cc) <- c("iso3","LocID")
pop <- subset(pop,Variant=="Medium" & Sex=="Both")
View(pop)
pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
names(cc) <- c("iso3","LocID")
pop <- subset(pop,Variant=="Medium" & Sex=="Both")
pop <- merge(pop,cc,by="LocID")
setnames(pop,"Time","year")
pop <- data.table(pop)
pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
View(pop)
usa <- subset(pop,iso3=="USA")
View(usa)
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
keep <- c("iso3","type","ppp","year")
dat <- dat[keep]
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat <- subset(dat,latest)
dat$year <- round(dat$year)
dat <- merge(
dat
,pop
,by=c("iso3","year")
)
View(dat)
dat$latest <- NULL
names(dat)
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
names(cc) <- c("iso3","LocID")
pop <- subset(pop,Variant=="Medium" & Sex=="Both")
pop <- merge(pop,cc,by="LocID")
setnames(pop,"Time","year")
pop <- data.table(pop)
pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
keep <- c("iso3","type","ppp","year")
dat <- dat[keep]
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat <- subset(dat,latest)
dat$year <- round(dat$year)
dat <- merge(
dat
,pop
,by=c("iso3","year")
)
dat[latest:=NULL]
names(dat)
keep <- c("iso3","year","type","ppp","pop")
dat <- dat[keep]
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
names(cc) <- c("iso3","LocID")
pop <- subset(pop,Variant=="Medium" & Sex=="Both")
pop <- merge(pop,cc,by="LocID")
setnames(pop,"Time","year")
pop <- data.table(pop)
pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
keep <- c("iso3","type","ppp","year")
dat <- dat[keep]
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat <- subset(dat,latest)
dat$year <- round(dat$year)
dat <- merge(
dat
,pop
,by=c("iso3","year")
)
keep <- c("iso3","year","type","ppp","pop")
dat <- data.frame(dat)
dat <- dat[keep]
View(dat)
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
# pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
# cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
# cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
# names(cc) <- c("iso3","LocID")
# pop <- subset(pop,Variant=="Medium" & Sex=="Both")
# pop <- merge(pop,cc,by="LocID")
# setnames(pop,"Time","year")
# pop <- data.table(pop)
# pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
keep <- c("iso3","type","ppp","year")
dat <- dat[keep]
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat <- subset(dat,latest)
# dat <- merge(
#   dat
#   ,pop
#   ,by=c("iso3","year")
# )
# keep <- c("iso3","year","type","ppp","pop")
# dat <- data.frame(dat)
# dat <- dat[keep]
View(dat)
dat$latest <- NULL
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
# pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
# cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
# cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
# names(cc) <- c("iso3","LocID")
# pop <- subset(pop,Variant=="Medium" & Sex=="Both")
# pop <- merge(pop,cc,by="LocID")
# setnames(pop,"Time","year")
# pop <- data.table(pop)
# pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
keep <- c("iso3","type","ppp","year")
dat <- dat[keep]
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat <- subset(dat,latest)
# dat <- merge(
#   dat
#   ,pop
#   ,by=c("iso3","year")
# )
# keep <- c("iso3","year","type","ppp","pop")
# dat <- data.frame(dat)
# dat <- dat[keep]
dat <- data.frame(dat)
dat$latest <- NULL
View(dat)
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
# pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
# cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
# cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
# names(cc) <- c("iso3","LocID")
# pop <- subset(pop,Variant=="Medium" & Sex=="Both")
# pop <- merge(pop,cc,by="LocID")
# setnames(pop,"Time","year")
# pop <- data.table(pop)
# pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- read.csv("data.csv",as.is=TRUE)
names(dat) <- c("iso3","type","ppp","year","pop")
dat <- dat[order(dat$iso3,dat$year),]
dat <- data.table(dat)
dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
dat <- subset(dat,latest)
# dat <- merge(
#   dat
#   ,pop
#   ,by=c("iso3","year")
# )
# keep <- c("iso3","year","type","ppp","pop")
# dat <- data.frame(dat)
# dat <- dat[keep]
dat <- data.frame(dat)
dat$latest <- NULL
View(dat)
getwd()
write.csv(dat,"data_new.csv",row.names=FALSE)
read.csv("D:/Documents/Data/lorenze.csv")
dat <- read.csv("D:/Documents/Data/lorenze.csv")
View(dat)
dat <- read.csv("data.csv",as.is=TRUE)
View(dat)
dat <- read.csv("D:/Documents/Data/lorenze.csv",header=FALSE)
View(dat)
keep <- c("V1","V2","V3","V4","V7")
dat <- dat[keep]
View(dat)
names(dat) <- c("iso3","type","year","povline","headcount")
View(dat)
dat <- dat[order(dat$iso3,dat$povline),]
View(dat)
dat$year <- round(dat$year)
View(dat)
pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
names(cc) <- c("iso3","LocID")
pop <- subset(pop,Variant=="Medium" & Sex=="Both")
pop <- merge(pop,cc,by="LocID")
setnames(pop,"Time","year")
pop <- data.table(pop)
pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- merge(
dat
,pop
,by=c("iso3","year")
)
View(dat)
dat$p <- dat$pop*dat$headcount
View(dat)
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
#
# dat <- read.csv("data.csv",as.is=TRUE,header=FALSE)
# names(dat) <- c("iso3","type","ppp","year","pop")
#
# dat <- dat[order(dat$iso3,dat$year),]
# dat <- data.table(dat)
# dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
# dat <- subset(dat,latest)
#
# dat <- data.frame(dat)
# dat$latest <- NULL
#
# write.csv(dat,"data_new.csv",row.names=FALSE)
dat <- read.csv("D:/Documents/Data/lorenze.csv",header=FALSE)
keep <- c("V1","V2","V3","V4","V7")
dat <- dat[keep]
names(dat) <- c("iso3","type","year","l","headcount")
dat <- dat[order(dat$iso3,dat$povline),]
dat$year <- round(dat$year)
pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
names(cc) <- c("iso3","LocID")
pop <- subset(pop,Variant=="Medium" & Sex=="Both")
pop <- merge(pop,cc,by="LocID")
setnames(pop,"Time","year")
pop <- data.table(pop)
pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- merge(
dat
,pop
,by=c("iso3","year")
)
dat$p <- dat$pop*dat$headcount
dat <- data.table(dat)
lorenze <- dat[,.(p=sum(p,na.rm=TRUE)),by=.(l)]
View(lorenze)
library(data.table)
wd <- "C:/git/alexm-util/DevInit/PovCalNet/"
setwd(wd)
#
# dat <- read.csv("data.csv",as.is=TRUE,header=FALSE)
# names(dat) <- c("iso3","type","ppp","year","pop")
#
# dat <- dat[order(dat$iso3,dat$year),]
# dat <- data.table(dat)
# dat$latest <- rev(!duplicated(dat[,list(rev(dat$iso3))]))
# dat <- subset(dat,latest)
#
# dat <- data.frame(dat)
# dat$latest <- NULL
#
# write.csv(dat,"data_new.csv",row.names=FALSE)
dat <- read.csv("D:/Documents/Data/lorenze.csv",header=FALSE)
keep <- c("V1","V2","V3","V4","V7")
dat <- dat[keep]
names(dat) <- c("iso3","type","year","l","headcount")
dat <- dat[order(dat$iso3,dat$l),]
dat$year <- round(dat$year)
pop <- read.csv("D:/Documents/Data/P20 baseline/undesa.pop.csv")
cc <- read.csv("D:/Documents/Data/P20 baseline/country-codes.csv")
cc <- cc[c("ISO3166.1.Alpha.3","ISO3166.1.numeric")]
names(cc) <- c("iso3","LocID")
pop <- subset(pop,Variant=="Medium" & Sex=="Both")
pop <- merge(pop,cc,by="LocID")
setnames(pop,"Time","year")
pop <- data.table(pop)
pop <- pop[,.(pop=sum(Value,na.rm=TRUE)*1000),by=.(year,iso3)]
dat <- merge(
dat
,pop
,by=c("iso3","year")
)
dat$p <- dat$pop*dat$headcount
dat <- data.table(dat)
lorenze <- dat[,.(p=sum(p,na.rm=TRUE)),by=.(l)]
View(lorenze)
lorenz <- dat[,.(p=sum(p,na.rm=TRUE)),by=.(l)]
lorenz <- lorenz[order(lorenz$l),]
View(lorenz)
plot(lorenz)
plot(p~l,data=lorenz)
plot(l+p,data=lorenz)
plot(l~p,data=lorenz)
View(dat)
dat <- dat[order(dat$iso3,dat$l),]
View(dat)
write.csv(dat,"lorenz.csv",row.names=FALSE)
getwd*()
getwd()
